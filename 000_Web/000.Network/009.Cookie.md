# 쿠키

## 헤더 
- `Set-Cookie`: 서버에서 클라이언트로 쿠키 전달.
- `Cookie`: 클라이언트가 서버에서 받은 쿠키 저장하고, HTTP요청시 서버로 전달.

## Stateless
 - HTTP는 무상태 프로토컬이다 
 - 클라이언트와 서버가 요청과 응답을 주고 받으면 연결이 끊어진다 
 - 클라리언트가 다시 요청하면 서버는 이전 요청을 기억하지 못한다 
 - 클라리언트와 서버는 서로 상태를 유지하지 않는다.

### 쿠키는 무엇인가
 - 대안: 모든 요청에 사용자 정보 포함 URI에
 - 하지만 모든 요청과 링크에 사용자 정보 포함해야함 
    - 보안에 문제가 있고 
    - 너무 많은 정보를 보내야함 
- 브라우저를 완전히 종료하고 다시 열면?
- 해결! --> 쿠키 
    - 웹은 포스트해서 사용자 로그인 함
        - `POST /login HTTP 1.1`
        - `user = 홍길동`
    - 서버에서 응답. 
        - `HTTP/1.1 200 ok`
        - `Set-Cookie: user = 홍길동`
    - 웹 브라우저 내부에 있는 `쿠키 저장소`에 저장.
    - 로그인 이루에 자동적으로 쿠키를 뒤저서 안에있는 정보 같이 보냄.
        - `GET /welcome HTTP 1.1`
        - `Cookie: user=홍길동`
- 쿠키를 서버에서 세팅할때
    - sessionID, expires, path, domain, Secure
    - 사용자 로그인 세션 관리,
    - 광고 정보 트래킹
    - 쿠키 정보는 항상 서버에 전송됨
    - 쿠키는 무조건! 서버에 계속 보냄 
    - 보안에 민감한 데이터는 절대 저장하면 안됨


## 쿠키 생명주기
- Expires, max-age
- Set-Cookie: `expires` = Sat, 26-Dec-2020 04:39:21 GMT
    - 만료일이 되면 쿠키 삭제
- Set-Cookie: `max-age` = 36000(3600초)
    - 0이나 음수를 지정하면 쿠키 삭제
- `Session Cookie`: 만료 날짜를 생략하면 브라우저 종료시 까지만 유지
- `영속 Cookie`: 만료 날짜를 입력하면 해당 날짜까지 유지.

## 쿠키 도메인 
- `명시`
    - 명시한 문서 기준 도메인 + 서브 도메인 포함
    - domain=example.org
        - example.org 쿠키 접근
        - dev.example.org 쿠키 접근
- `생략`
    - 현재 문서 기준 도매인만 적용
        - example.org 에서만 쿠키 접근
        - dev.example.org는 쿠키 미접근

## 쿠키 격로
- 경로를 명시하면 `하위 경로 페이지만 쿠키 접근 `

## 쿠키 보안 
- `Secure` --> HTTPS인 경우에만 보냄 
- `HttpOnly` --> 자바스크립트에서 접근 불가
- `SameSite` --> XSRF 고격 방지
